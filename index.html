async function loadBalances() {
    try {
        console.log('Attempting to load balances...');
        const usdcBalance = await usdcContract.methods.balanceOf(accounts[0]).call();
        console.log(`USDC balance: ${usdcBalance}`);
        document.getElementById('usdc-balance').innerText = web3.utils.fromWei(usdcBalance, 'mwei') + ' USDC';

        const stakedBalance = await contract.methods.getBalance(accounts[0]).call();
        console.log(`Staked balance: ${stakedBalance}`);
        document.getElementById('staked-balance').innerText = web3.utils.fromWei(stakedBalance, 'mwei') + ' USDC';

        const rewardBalance = await contract.methods.getRewardBalance(accounts[0]).call();
        console.log(`Reward balance: ${rewardBalance}`);
        document.getElementById('reward-balance').innerText = web3.utils.fromWei(rewardBalance, 'mwei') + ' USDC';

        console.log('Balances loaded successfully!');
    } catch (error) {
        console.error('Error loading balances', error);
    }
}

async function stakeTokens() {
    const amount = document.getElementById('stake-amount').value;
    if (amount > 0) {
        try {
            console.log('Staking tokens...');
            const amountWei = web3.utils.toWei(amount, 'mwei');
            await usdcContract.methods.approve(contractAddress, amountWei).send({ from: accounts[0] });
            await contract.methods.stake(amountWei).send({ from: accounts[0] });
            alert('Tokens staked successfully!');
            await loadBalances();
        } catch (error) {
            console.error('Error staking tokens', error);
        }
    } else {
        alert('Please enter a valid amount to stake.');
    }
}

async function claimRewards() {
    try {
        console.log('Claiming rewards...');
        await contract.methods.claimReward().send({ from: accounts[0] });
        alert('Rewards claimed successfully!');
        await loadBalances();
    } catch (error) {
        console.error('Error claiming rewards', error);
    }
}
